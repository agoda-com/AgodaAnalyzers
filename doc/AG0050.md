# AG0050: Generated client model used in controller action

## Cause

Controller actions are using generated client models (from assemblies ending with ".Client" or ".Graphql") in their return types or input parameters.

## Rule description

Controller actions should not use generated client models directly in their parameters or return types (including nested properties) to avoid tight coupling between data/dependency layer models and API response models. This practice leads to better separation of concerns and maintainability.

Generated client models are typically created by tools for HTTP clients or GraphQL clients and are intended for internal communication between services, not for public API contracts.

## How to fix violations

Create dedicated request/response models for your API endpoints instead of reusing generated client models.

## When to suppress warnings

This warning should rarely be suppressed. Consider suppression only when:
- You have a valid architectural reason for the coupling
- The generated models are specifically designed to be part of your public API contract

## Example of a violation

```csharp
using UserService.Client;
using Microsoft.AspNetCore.Mvc;

public class UsersController : Controller
{
    // Violation: Using generated client model as return type
    public ActionResult<UserDto> GetUser(int id)
    {
        return new UserDto { Name = "John" };
    }
    
    // Violation: Using generated client model as parameter
    public ActionResult UpdateUser(UserDto userDto)
    {
        // Update logic
        return Ok();
    }
    
    // Violation: Using generated client model in nested property
    public ActionResult<UserResponse> GetUserDetails(int id)
    {
        return new UserResponse 
        { 
            User = new UserDto { Name = "John" } // UserDto from .Client assembly
        };
    }
}
```

## Example of how to fix

```csharp
using Microsoft.AspNetCore.Mvc;

public class UsersController : Controller
{
    // Fixed: Using dedicated response model
    public ActionResult<UserResponse> GetUser(int id)
    {
        return new UserResponse { Name = "John" };
    }
    
    // Fixed: Using dedicated request model
    public ActionResult UpdateUser(UpdateUserRequest request)
    {
        // Update logic
        return Ok();
    }
    
    // Fixed: Using dedicated models throughout
    public ActionResult<UserDetailsResponse> GetUserDetails(int id)
    {
        return new UserDetailsResponse 
        { 
            User = new UserModel { Name = "John" } // Dedicated model
        };
    }
}

// Dedicated API models
public class UserResponse
{
    public string Name { get; set; }
}

public class UpdateUserRequest
{
    public string Name { get; set; }
}

public class UserDetailsResponse
{
    public UserModel User { get; set; }
}

public class UserModel
{
    public string Name { get; set; }
}
```

## Configuration

This analyzer detects generated models by:
- Assembly names ending with ".Client" (case-insensitive)
- Assembly names ending with ".Graphql" (case-insensitive)
- As a fallback, namespace names ending with "Client" or "Graphql"

## Technical debt

This rule has an estimated technical debt of 15 minutes per violation.

## Related rules

- AG0003: Do not pass HttpContext as method argument
- AG0009: Do not pass IHttpContextAccessor as method argument 