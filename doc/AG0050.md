# Don't Use Generated Client Models in Controller Actions

ID: AG0050

Type: Design / Architecture

## Summary

Controller actions should not use generated client models (from assemblies ending with ".Client" or ".Graphql") in their return types or input parameters to avoid tight coupling between data/dependency layer models and API response models.

## Explanation

Using generated client models directly in controller actions creates several problems:

- Tight coupling between internal service models and public API contracts
- Changes in dependency services break your API
- Generated models may expose internal implementation details
- Difficult to version your API independently
- Mixed concerns between data layer and presentation layer
- Harder to maintain consistent API contracts

### Don't ❌

```csharp
using UserService.Client;
using Microsoft.AspNetCore.Mvc;

public class UsersController : Controller
{
    // Violation: Using generated client model as return type
    public ActionResult<UserDto> GetUser(int id)
    {
        return new UserDto { Name = "John" };
    }
    
    // Violation: Using generated client model as parameter
    public ActionResult UpdateUser(UserDto userDto)
    {
        return Ok();
    }
    
    // Violation: Generated model in nested property
    public ActionResult<UserResponse> GetUserDetails(int id)
    {
        return new UserResponse 
        { 
            User = new UserDto { Name = "John" } // UserDto from .Client assembly
        };
    }
}
```

### Do ✅

```csharp
using Microsoft.AspNetCore.Mvc;

public class UsersController : Controller
{
    // Use dedicated response models
    public ActionResult<UserResponse> GetUser(int id)
    {
        return new UserResponse { Name = "John" };
    }
    
    // Use dedicated request models
    public ActionResult UpdateUser(UpdateUserRequest request)
    {
        return Ok();
    }
    
    // Use dedicated models throughout
    public ActionResult<UserDetailsResponse> GetUserDetails(int id)
    {
        return new UserDetailsResponse 
        { 
            User = new UserModel { Name = "John" }
        };
    }
}

// Dedicated API models
public class UserResponse
{
    public string Name { get; set; }
}

public class UpdateUserRequest
{
    public string Name { get; set; }
}
```

## Why Avoid Generated Client Models?

- Breaks separation of concerns
- Creates tight coupling
- Exposes internal implementation
- Makes API versioning difficult
- Reduces maintainability
- Limits architectural flexibility

Instead:

- Create dedicated request/response models
- Map between client models and API models
- Design API contracts independently
- Maintain clean boundaries
- Use proper data transfer objects
- Keep concerns separated

Remember: Your API contract should be stable and independent of internal service dependencies.

## Technical Debt

This rule has an estimated technical debt of 15 minutes per violation.
